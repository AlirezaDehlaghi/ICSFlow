

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ICSFLowGenerator in Docs &mdash; ICSFlow 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API reference" href="api.html" />
    <link rel="prev" title="Welcome to ICSFLow’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ICSFlow
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">ICSFLowGenerator in Docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#capabilities">Capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#arguments">Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-runtime-arguments">Sample runtime arguments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ICSFlow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ICSFLowGenerator in Docs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/readme_copy.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="icsflowgenerator-in-docs">
<h1>ICSFLowGenerator in Docs<a class="headerlink" href="#icsflowgenerator-in-docs" title="Link to this heading"></a></h1>
<p>This is tool for offline and online processing of network packets and creating network flows.</p>
<section id="capabilities">
<h2>Capabilities<a class="headerlink" href="#capabilities" title="Link to this heading"></a></h2>
<p>Reading packets could be done in two modes</p>
<ul class="simple">
<li><p>offline from PCAP file</p></li>
<li><p>online sniffing of LAN</p></li>
</ul>
<p>We can annotate data using True labels or predicted labels</p>
<ul class="simple">
<li><p>Ture Labels: proving attack history log files, it can detect which flows are malicious</p></li>
<li><p>Predicated Labels: We could also try to analyze network flows with pretrained model and predict its anomality.</p></li>
</ul>
</section>
<section id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Link to this heading"></a></h2>
<p>positional arguments:  <a class="reference external" href="action:sniff%7Cconvert">action:sniff|convert</a>
Choose online sniffing of a LAN or offline converting
PCAP file</p>
<p>options:
-h, –help            show this help message and exit
–source <source file or LAN name>&gt;
In online sniffing provide <LAN name> and in offline
converting provide <PCAP file>
–interval interval in seconds
interval to compute flows
–attacks attack log csv file address
attack file address for finding true flows’ label
–predictor model      address of pre trained ml model to classify incoming
flows
–target_stream <Stream address>
Target server address to stream out network flows
–target_file <csv file name>
csv file to output</p>
</section>
<section id="sample-runtime-arguments">
<h2>Sample runtime arguments<a class="headerlink" href="#sample-runtime-arguments" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>sniffing from Wi-Fi lan without annotation and writing flows to file:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sniff</span> <span class="o">--</span><span class="n">source</span>   <span class="n">Wi</span><span class="o">-</span><span class="n">Fi</span>   <span class="o">--</span><span class="n">interval</span>   <span class="mf">0.5</span>   <span class="o">--</span><span class="n">target_file</span>   <span class="n">output</span><span class="o">/</span><span class="n">sniffed</span><span class="o">.</span><span class="n">csv</span> 
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>offline generating of network flows from PCAP file with True label annotation and writing flows to file::</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Convert</span> 
    <span class="o">--</span><span class="n">source</span>        <span class="nb">input</span><span class="o">/</span><span class="n">traffic</span><span class="o">.</span><span class="n">pcap</span>
    <span class="o">--</span><span class="n">interval</span>      <span class="mf">0.5</span>
    <span class="o">--</span><span class="n">attacks</span>       <span class="nb">input</span><span class="o">/</span><span class="n">attacker_machine_summary</span><span class="o">.</span><span class="n">csv</span>
    <span class="o">--</span><span class="n">target_file</span>   <span class="n">output</span><span class="o">/</span><span class="n">sniffed</span><span class="o">.</span><span class="n">csv</span> 
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>offline generating of network flows from PCAP file with True label annotation and prediction and writing flows to file:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Convert</span> 
    <span class="o">--</span><span class="n">source</span>                <span class="nb">input</span><span class="o">/</span><span class="n">traffic</span><span class="o">.</span><span class="n">pcap</span>
    <span class="o">--</span><span class="n">interval</span>              <span class="mf">0.5</span>
    <span class="o">--</span><span class="n">attacks</span>               <span class="nb">input</span><span class="o">/</span><span class="n">attacker_machine_summary</span><span class="o">.</span><span class="n">csv</span>
    <span class="o">--</span><span class="n">predictor</span>             <span class="nb">input</span><span class="o">/</span><span class="n">predict_model</span><span class="o">.</span><span class="n">joblib</span>
    <span class="o">--</span><span class="n">target_file</span>           <span class="n">output</span><span class="o">/</span><span class="n">sniffed</span><span class="o">.</span><span class="n">csv</span>  
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Convert</span>  <span class="o">--</span><span class="n">source</span>  <span class="nb">input</span><span class="o">/</span><span class="n">traffic</span><span class="o">.</span><span class="n">pcap</span> <span class="o">--</span><span class="n">interval</span> <span class="mf">0.5</span> <span class="o">--</span><span class="n">attacks</span>  <span class="nb">input</span><span class="o">/</span><span class="n">attacker_machine_summary</span><span class="o">.</span><span class="n">csv</span>  <span class="o">--</span><span class="n">target_file</span>  <span class="n">output</span><span class="o">/</span><span class="n">sniffed</span><span class="o">.</span><span class="n">csv</span> 
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>offline generating of network flows from PCAP file with True label annotation and prediction and sending them to both target file and MQTT server with credential:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Convert</span> 
    <span class="o">--</span><span class="n">source</span>                    <span class="nb">input</span><span class="o">/</span><span class="n">traffic</span><span class="o">.</span><span class="n">pcap</span>
    <span class="o">--</span><span class="n">interval</span>                  <span class="mf">0.5</span>
    <span class="o">--</span><span class="n">attacks</span>                   <span class="nb">input</span><span class="o">/</span><span class="n">attacker_machine_summary</span><span class="o">.</span><span class="n">csv</span>
    <span class="o">--</span><span class="n">predictor</span>                 <span class="nb">input</span><span class="o">/</span><span class="n">predict_model</span><span class="o">.</span><span class="n">joblib</span>
    <span class="o">--</span><span class="n">target_file</span>               <span class="n">output</span><span class="o">/</span><span class="n">sniffed</span><span class="o">.</span><span class="n">csv</span> 
    <span class="o">--</span><span class="n">target_connection</span>         <span class="n">sample_connection</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to ICSFLow’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Alireza Dehlaghi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>